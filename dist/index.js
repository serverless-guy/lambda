"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}).apply(this,arguments)};function responser(r,e,n){return void 0===e&&(e=200),void 0===n&&(n={}),__assign({body:JSON.stringify(r),headers:{"Access-Control-Allow-Origin":"*"},statusCode:e||200},n)}function defaultErrorHandler(r,e){return responser({errorCode:e.name,errorMessage:e.message},500)}function noop(){}function middlewareHandler(n,t){for(var r=[],e=2;e<arguments.length;e++)r[e-2]=arguments[e];if(r.length){var o=r.reduce(function(r,e){return r({event:n,context:t},function(){return e})});return o?o({event:n,context:t},function(){return noop}):o}}function isValidHttpResponseObject(r){if(!r)return!1;var e=r.hasOwnProperty("body"),n=r.hasOwnProperty("headers"),t=r.hasOwnProperty("statusCode");return e&&n&&t}function resolverNonHttp(e,n,r){for(var t=[],o=3;o<arguments.length;o++)t[o-3]=arguments[o];return new Promise(function(r){return r(middlewareHandler.apply(void 0,[e,n].concat(t)))}).then(function(){return r(e)})}function wrapHttpResponse(r){return isValidHttpResponseObject(r)?r:{body:JSON.stringify(r),headers:{"Access-Control-Allow-Origin":"*"},statusCode:200}}function httpResponseHandler(r,e){var n=e(r,responser);return n||(n={}),n.then?n.then(wrapHttpResponse):wrapHttpResponse(n)}function resolver(e,n,r){for(var t=[],o=3;o<arguments.length;o++)t[o-3]=arguments[o];return new Promise(function(r){return r(middlewareHandler.apply(void 0,[e,n].concat(t)))}).then(function(){return httpResponseHandler(e,r)})}function wrapper(t,o){for(var s=[],r=2;r<arguments.length;r++)s[r-2]=arguments[r];return function(e,r){var n=resolver.apply(void 0,[e,r,t].concat(s));return o||(o=defaultErrorHandler),n.catch(function(r){return o(e,r)})}}function wrapperNonHttp(t,o){for(var s=[],r=2;r<arguments.length;r++)s[r-2]=arguments[r];return function(e,r){var n=resolverNonHttp.apply(void 0,[e,r,t].concat(s));return o||(o=defaultErrorHandler),n.catch(function(r){return o(e,r)})}}exports.defaultErrorHandler=defaultErrorHandler,exports.middlewareHandler=middlewareHandler,exports.isValidHttpResponseObject=isValidHttpResponseObject,exports.resolverNonHttp=resolverNonHttp,exports.wrapperNonHttp=wrapperNonHttp,exports.noop=noop,exports.resolver=resolver,exports.responser=responser,exports.wrapper=wrapper;
