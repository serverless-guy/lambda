"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}).apply(this,arguments)};function chain(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Promise.all(r).then(getLastPerformedFunction)}function getLastPerformedFunction(r){return r[r.length-1]}function resolver(t,a,o){for(var s=[],r=3;r<arguments.length;r++)s[r-3]=arguments[r];return new Promise(function(r,e){if(!s)return r(handleLambdaHandler(t,o,responser));var n=s.map(function(r){return r(t,a)});return chain.apply(void 0,n.concat([handleLambdaHandler(t,o,responser)])).then(r).catch(e)})}function handleLambdaHandler(r,e,n){var t=e(r,n);return t.then?t.then(wrapResponse):wrapResponse(t)}function validLambdaResponseObject(r){var e=r.hasOwnProperty("body"),n=r.hasOwnProperty("headers"),t=r.hasOwnProperty("statusCode");return e&&n&&t}function wrapResponse(r){return validLambdaResponseObject(r)?r:{body:JSON.stringify(r),headers:{"Access-Control-Allow-Origin":"*"},statusCode:200}}function responser(r,e,n){return void 0===e&&(e=200),void 0===n&&(n={}),__assign({body:JSON.stringify(r),headers:{"Access-Control-Allow-Origin":"*"},statusCode:e||200},n)}function lambdaWrap(t,a){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];return function(e,r){var n=resolver.apply(void 0,[e,r,t].concat(o));return a&&(n=n.catch(function(r){return a(e,r)})),n}}exports.lambdaWrap=lambdaWrap,exports.responser=responser,exports.resolver=resolver;
