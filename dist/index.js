"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)};function __awaiter(o,i,s,u){return new(s||(s=Promise))(function(e,n){function t(e){try{a(u.next(e))}catch(e){n(e)}}function r(e){try{a(u.throw(e))}catch(e){n(e)}}function a(n){n.done?e(n.value):new s(function(e){e(n.value)}).then(t,r)}a((u=u.apply(o,i||[])).next())})}function __generator(t,r){var a,o,i,e,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=r.call(t,s)}catch(e){n=[6,e],o=0}finally{a=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}function promiseWrap(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return new Promise(function(e,n){return t.apply(void 0,r.concat([e])).catch(n)})}function lambda(s,u){return void 0===u&&(u={}),function(o,i){return __awaiter(this,void 0,void 0,function(){var n,t,r,a;return __generator(this,function(e){switch(e.label){case 0:n=new s(u),e.label=1;case 1:return e.trys.push([1,4,,5]),t={event:__assign({},o),context:__assign({},i)},[4,promiseWrap(n.beforeFire,__assign({},t))];case 2:return t=e.sent(),[4,n.fire(__assign({},t),n.responseTemplate)];case 3:return r=e.sent(),[2,n.afterFire(__assign({},t),r)];case 4:return a=e.sent(),[2,n.handleError({event:o,context:i},a)];case 5:return[2]}})})}}exports.lambda=lambda;
